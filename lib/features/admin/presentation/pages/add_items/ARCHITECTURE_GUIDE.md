# ğŸ—ï¸ Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ© - Ù†Ø¸Ø§Ù… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª

## ğŸ“‹ **Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©**

Ù‡Ø°Ø§ Ø§Ù„Ø¯Ù„ÙŠÙ„ ÙŠØ´Ø±Ø­ Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ© Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ù„Ù†Ø¸Ø§Ù… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§ØªØŒ Ù…Ù† Data Layer Ø¥Ù„Ù‰ Presentation LayerØŒ Ù…Ø¹ Ø´Ø±Ø­ ÙƒÙ„ Ø·Ø¨Ù‚Ø© ÙˆÙ…Ø³Ø¤ÙˆÙ„ÙŠØ§ØªÙ‡Ø§.

---

## ğŸ”— **Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ù…Ø¹ Ù†Ø¸Ø§Ù… Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© (Menu System)**

### **ğŸ¯ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©:**

**`add_items/`** Ùˆ **`menu/`** Ù‡Ù…Ø§ Ù…ÙƒÙˆÙ†Ø§Ù† Ù…ØªÙƒØ§Ù…Ù„Ø§Ù† ÙÙŠ Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø·Ø¹Ù…:

#### **1. Ø§Ù„ØªØ¯ÙÙ‚ Ø§Ù„Ù…Ù†Ø·Ù‚ÙŠ:**
```
ğŸ“ Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯ (add_items/) 
    â†“
ğŸ’¾ Ø­ÙØ¸ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    â†“
ğŸ“‹ Ø¹Ø±Ø¶ ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© (menu/)
```

#### **2. Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª Ø§Ù„Ù…ØªØ¨Ø§ÙŠÙ†Ø©:**

**`add_items/` (Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø¶Ø§ÙØ©):**
- âœ… **Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù†ØªØ¬Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©**
- âœ… **ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±**
- âœ… **Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©**
- âœ… **Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙØ¦Ø§Øª ÙˆØ§Ù„ØªØµÙ†ÙŠÙØ§Øª**
- âœ… **Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªÙˆÙØ± ÙˆØ§Ù„Ù…Ù…ÙŠØ²Ø§Øª**

**`menu/` (Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ø±Ø¶):**
- âœ… **Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø¶Ø§ÙØ©**
- âœ… **ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø§Øª**
- âœ… **Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª**
- âœ… **ØªØ¹Ø¯ÙŠÙ„ ÙˆØ­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª**
- âœ… **Ø¥Ø¯Ø§Ø±Ø© Ø­Ø§Ù„Ø© Ø§Ù„ØªÙˆÙØ±**

#### **3. Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ù†Ø¸Ø§Ù…ÙŠÙ†:**

**Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¥Ù„Ù‰ Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬:**
```dart
// ÙÙŠ menu page
Navigator.pushNamed(context, '/admin/add-item');
```

**Ù…Ù† Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¥Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©:**
```dart
// Ø¨Ø¹Ø¯ Ø­ÙØ¸ Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­
Navigator.pop(context); // Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©
```

#### **4. Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:**

**API Endpoints Ø§Ù„Ù…Ø´ØªØ±ÙƒØ©:**
- `GET /admin/products` - Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©
- `POST /admin/products` - Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯
- `PUT /admin/products/{id}` - ØªØ­Ø¯ÙŠØ« Ù…Ù†ØªØ¬
- `DELETE /admin/products/{id}` - Ø­Ø°Ù Ù…Ù†ØªØ¬

**Data Models Ø§Ù„Ù…Ø´ØªØ±ÙƒØ©:**
- `Product` Entity - Ø§Ù„ÙƒÙŠØ§Ù† Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
- `ProductModel` - Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- `ProductRepository` - ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹

#### **5. Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ© Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„Ø©:**

```
ğŸ—ï¸ Clean Architecture
â”œâ”€â”€ ğŸ“ Domain Layer (Ù…Ø´ØªØ±Ùƒ)
â”‚   â”œâ”€â”€ entities/product.dart
â”‚   â””â”€â”€ repositories/product_repository.dart
â”œâ”€â”€ ğŸ“ Data Layer (Ù…Ø´ØªØ±Ùƒ)
â”‚   â”œâ”€â”€ models/product_model.dart
â”‚   â””â”€â”€ repositories/product_repository_impl.dart
â””â”€â”€ ğŸ“ Presentation Layer (Ù…Ù†ÙØµÙ„)
    â”œâ”€â”€ ğŸ“ add_items/
    â”‚   â””â”€â”€ pages/admin_add_item_page.dart
    â””â”€â”€ ğŸ“ menu/
        â””â”€â”€ pages/admin_menu_page.dart
```

#### **6. ØªØ¯ÙÙ‚ Ø§Ù„Ø¹Ù…Ù„ (Workflow):**

**Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯:**
1. **Admin** â†’ ÙŠÙØªØ­ ØµÙØ­Ø© Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬
2. **Add Item Page** â†’ ÙŠÙ…Ù„Ø£ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„ØµÙˆØ±
3. **API Call** â†’ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¨Ø§Ùƒ Ø¥Ù†Ø¯
4. **Database** â†’ Ø­ÙØ¸ Ø§Ù„Ù…Ù†ØªØ¬
5. **Success** â†’ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©
6. **Menu Page** â†’ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ø¬Ø¯ÙŠØ¯

**Ø¹Ø±Ø¶ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:**
1. **Menu Page** â†’ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ù† API
2. **Filter/Search** â†’ ØªØµÙÙŠØ© ÙˆØ¨Ø­Ø«
3. **Edit/Delete** â†’ ØªØ¹Ø¯ÙŠÙ„ Ø£Ùˆ Ø­Ø°Ù
4. **Real-time Update** â†’ ØªØ­Ø¯ÙŠØ« ÙÙˆØ±ÙŠ Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©

#### **7. Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù…Ø´ØªØ±ÙƒØ©:**

**âœ… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø§Ù„Ø©:**
- BlocProvider Ù„Ù„Ù€ State Management
- Cubit Ù„Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- Real-time updates

**âœ… Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡:**
- Error handling ÙÙŠ ÙƒÙ„ØªØ§ Ø§Ù„ØµÙØ­ØªÙŠÙ†
- User-friendly error messages
- Retry mechanisms

**âœ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµØ­Ø©:**
- Form validation
- Data integrity checks
- API response validation

---

## ğŸ—‚ï¸ **Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª**

```
lib/features/admin/presentation/pages/add_items/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â””â”€â”€ product_model.dart          # Data Model
â”‚   â”œâ”€â”€ repositories/
â”‚   â”‚   â””â”€â”€ product_repository_impl.dart # Repository Implementation
â”‚   â””â”€â”€ datasources/
â”‚       â””â”€â”€ remoteDataSource/
â”‚           â””â”€â”€ product_remote_data_source_imp.dart # API Calls
â”œâ”€â”€ domain/
â”‚   â”œâ”€â”€ entities/
â”‚   â”‚   â””â”€â”€ product.dart                # Business Entity
â”‚   â”œâ”€â”€ repositories/
â”‚   â”‚   â””â”€â”€ product_repository.dart     # Repository Interface
â”‚   â””â”€â”€ usecases/
â”‚       â”œâ”€â”€ create_product_usecase.dart # Business Logic
â”‚       â””â”€â”€ get_products_usecase.dart   # Get Products Logic
â””â”€â”€ presentation/
    â”œâ”€â”€ cubit/
    â”‚   â”œâ”€â”€ product_cubit.dart          # State Management
    â”‚   â”œâ”€â”€ product_events.dart         # Events
    â”‚   â””â”€â”€ product_states.dart         # States
    â”œâ”€â”€ pages/
    â”‚   â””â”€â”€ admin_add_item_page.dart    # UI
    â””â”€â”€ widgets/
        â””â”€â”€ index.dart                   # UI Components
```

---

## ğŸ—„ï¸ **1. Data Layer (Ø·Ø¨Ù‚Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª)**

### ğŸ“Š **1.1 Data Models**

**Ø§Ù„Ù…Ù„Ù:** `data/models/product_model.dart`

```dart
class ProductModel {
  final int? id;
  final String name;
  final String nameAr;
  final double price;
  final int mainCategoryId;
  // ... Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø­Ù‚ÙˆÙ„

  const ProductModel({
    required this.id,
    required this.name,
    required this.nameAr,
    required this.price,
    required this.mainCategoryId,
    // ... Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª
  });

  // âœ… Factory Methods Ù„Ù„ØªØ­ÙˆÙŠÙ„
  factory ProductModel.fromJson(Map<String, dynamic> json) {
    return ProductModel(
      id: json['id'],
      name: json['name'],
      nameAr: json['name_ar'],
      price: json['price'].toDouble(),
      mainCategoryId: json['main_category_id'],
      // ... Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø­Ù‚ÙˆÙ„
    );
  }

  factory ProductModel.fromEntity(Product entity) {
    return ProductModel(
      id: entity.id,
      name: entity.name,
      nameAr: entity.nameAr,
      price: entity.price,
      mainCategoryId: entity.mainCategoryId,
      // ... Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø­Ù‚ÙˆÙ„
    );
  }

  Map<String, dynamic> toJson() {
    return {
      'id': id,
      'name': name,
      'name_ar': nameAr,
      'price': price,
      'main_category_id': mainCategoryId,
      // ... Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø­Ù‚ÙˆÙ„
    };
  }

  Product toEntity() {
    return Product(
      id: id,
      name: name,
      nameAr: nameAr,
      price: price,
      mainCategoryId: mainCategoryId,
      // ... Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø­Ù‚ÙˆÙ„
    );
  }
}
```

**ğŸ¯ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:**
- **ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:** Ù…Ù† JSON Ø¥Ù„Ù‰ Model ÙˆØ§Ù„Ø¹ÙƒØ³
- **ØªØ­ÙˆÙŠÙ„ Model Ø¥Ù„Ù‰ Entity:** Ù„Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø·Ø¨Ù‚Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©
- **ØªØ­ÙˆÙŠÙ„ Entity Ø¥Ù„Ù‰ Model:** Ù„Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø·Ø¨Ù‚Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©

### ğŸ”Œ **1.2 Remote Data Source**

**Ø§Ù„Ù…Ù„Ù:** `data/datasources/remoteDataSource/product_remote_data_source_imp.dart`

```dart
abstract class ProductRemoteDataSource {
  Future<List<ProductModel>> getProducts();
  Future<ProductModel> createProduct(ProductModel product);
  Future<ProductModel> updateProduct(ProductModel product);
  Future<ProductModel> getProductById(int id);
}

class ProductRemoteDataSourceImpl implements ProductRemoteDataSource {
  final DioClient dioClient;

  ProductRemoteDataSourceImpl({required this.dioClient});

  @override
  Future<List<ProductModel>> getProducts() async {
    try {
      final response = await dioClient.get(ApiPath.products);
      final productsData = response.data['data'] as List;
      
      return productsData
          .map((json) => ProductModel.fromJson(json)) // âœ… ØªØ­ÙˆÙŠÙ„ Ù…Ù† JSON
          .toList();
    } catch (e) {
      throw Exception('Failed to get products: $e');
    }
  }

  @override
  Future<ProductModel> createProduct(ProductModel product) async {
    try {
      final response = await dioClient.post(
        ApiPath.products,
        data: product.toJson(), // âœ… ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ JSON
      );
      
      return ProductModel.fromJson(response.data['data']); // âœ… ØªØ­ÙˆÙŠÙ„ Ù…Ù† JSON
    } catch (e) {
      throw Exception('Failed to create product: $e');
    }
  }

  @override
  Future<ProductModel> updateProduct(ProductModel product) async {
    try {
      final response = await dioClient.put(
        '${ApiPath.products}/${product.id}',
        data: product.toJson(), // âœ… ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ JSON
      );
      
      return ProductModel.fromJson(response.data['data']); // âœ… ØªØ­ÙˆÙŠÙ„ Ù…Ù† JSON
    } catch (e) {
      throw Exception('Failed to update product: $e');
    }
  }
}
```

**ğŸ¯ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:**
- **API Calls:** Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…
- **ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:** Ù…Ù† Model Ø¥Ù„Ù‰ JSON ÙˆØ§Ù„Ø¹ÙƒØ³
- **Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡:** Ø§Ù„ØªÙ‚Ø§Ø· Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ø´Ø¨ÙƒØ©

### ğŸ”„ **1.3 Repository Implementation**

**Ø§Ù„Ù…Ù„Ù:** `data/repositories/product_repository_impl.dart`

```dart
class ProductRepositoryImpl implements ProductRepository {
  final ProductRemoteDataSource remoteDataSource;

  ProductRepositoryImpl({required this.remoteDataSource});

  @override
  Future<List<Product>> getProducts() async {
    try {
      final productModels = await remoteDataSource.getProducts();
      // âœ… ØªØ­ÙˆÙŠÙ„ Models Ø¥Ù„Ù‰ Entities
      return productModels.map((model) => model.toEntity()).toList();
    } catch (e) {
      throw Exception('Failed to get products: $e');
    }
  }

  @override
  Future<Product> createProduct(Product product) async {
    try {
      // âœ… ØªØ­ÙˆÙŠÙ„ Entity Ø¥Ù„Ù‰ Model
      final productModel = ProductModel.fromEntity(product);
      
      final createdProductModel = await remoteDataSource.createProduct(productModel);
      return createdProductModel.toEntity(); // âœ… ØªØ­ÙˆÙŠÙ„ Model Ø¥Ù„Ù‰ Entity
    } catch (e) {
      throw Exception('Failed to create product: $e');
    }
  }

  @override
  Future<Product> updateProduct(Product product) async {
    try {
      // âœ… ØªØ­ÙˆÙŠÙ„ Entity Ø¥Ù„Ù‰ Model
      final productModel = ProductModel.fromEntity(product);
      
      final updatedProductModel = await remoteDataSource.updateProduct(productModel);
      return updatedProductModel.toEntity(); // âœ… ØªØ­ÙˆÙŠÙ„ Model Ø¥Ù„Ù‰ Entity
    } catch (e) {
      throw Exception('Failed to update product: $e');
    }
  }
}
```

**ğŸ¯ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:**
- **ÙˆØ³ÙŠØ· Ø¨ÙŠÙ† Ø§Ù„Ø·Ø¨Ù‚Ø§Øª:** ÙŠØ±Ø¨Ø· Domain Ù…Ø¹ Data
- **ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:** Ù…Ù† Entity Ø¥Ù„Ù‰ Model ÙˆØ§Ù„Ø¹ÙƒØ³
- **Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡:** Ø§Ù„ØªÙ‚Ø§Ø· Ø£Ø®Ø·Ø§Ø¡ Repository

---

## ğŸ¯ **2. Domain Layer (Ø·Ø¨Ù‚Ø© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„)**

### ğŸ¢ **2.1 Business Entities**

**Ø§Ù„Ù…Ù„Ù:** `domain/entities/product.dart`

```dart
class Product {
  final int? id;
  final String name;
  final String nameAr;
  final String? description;
  final String? descriptionAr;
  final double price;
  final int mainCategoryId;
  final int? subCategoryId;
  final String? imageUrl;
  final bool isAvailable;
  final double? rating;
  final int? reviewCount;
  final int? preparationTime;
  final List<String>? ingredients;
  final List<String>? allergens;
  final bool isFeatured;
  final int? sortOrder;
  final DateTime? createdAt;
  final DateTime? updatedAt;

  const Product({
    required this.id,
    required this.name,
    required this.nameAr,
    this.description,
    this.descriptionAr,
    required this.price,
    required this.mainCategoryId,
    this.subCategoryId,
    this.imageUrl,
    this.isAvailable = true,
    this.rating,
    this.reviewCount,
    this.preparationTime,
    this.ingredients,
    this.allergens,
    this.isFeatured = false,
    this.sortOrder,
    this.createdAt,
    this.updatedAt,
  });
}
```

**ğŸ¯ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:**
- **ØªÙ…Ø«ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:** ØªÙ…Ø«ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ ÙÙŠ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„
- **Business Rules:** Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
- **Ø¹Ø¯Ù… Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø¹Ù„Ù‰ Data:** Ù„Ø§ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ JSON Ø£Ùˆ Database

### ğŸ“‹ **2.2 Repository Interface**

**Ø§Ù„Ù…Ù„Ù:** `domain/repositories/product_repository.dart`

```dart
abstract class ProductRepository {
  Future<List<Product>> getProducts();
  Future<Product> createProduct(Product product);
  Future<Product> updateProduct(Product product);
  Future<Product> getProductById(int id);
}
```

**ğŸ¯ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:**
- **ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª:** ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
- **ÙØµÙ„ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª:** Domain Ù„Ø§ ÙŠØ¹Ø±Ù ØªÙØ§ØµÙŠÙ„ Data
- **Ø³Ù‡ÙˆÙ„Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:** ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù… Mock Repository

### ğŸ§  **2.3 Use Cases (Business Logic)**

**Ø§Ù„Ù…Ù„Ù:** `domain/usecases/create_product_usecase.dart`

```dart
// âœ… Params Class Ù„Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¢Ù…Ù†
class CreateProductParams {
  final String name;
  final String nameAr;
  final String? description;
  final String? descriptionAr;
  final double price;
  final int mainCategoryId;
  final int? subCategoryId;
  final String? imageUrl;
  final bool isAvailable;
  final bool isFeatured;
  final int? preparationTime;
  final int? sortOrder;
  final List<String>? ingredients;
  final List<String>? allergens;

  CreateProductParams({
    required this.name,
    required this.nameAr,
    this.description,
    this.descriptionAr,
    required this.price,
    required this.mainCategoryId,
    this.subCategoryId,
    this.imageUrl,
    this.isAvailable = true,
    this.isFeatured = false,
    this.preparationTime,
    this.sortOrder,
    this.ingredients,
    this.allergens,
  });
}

class CreateProductUseCase {
  final ProductRepository repository;

  CreateProductUseCase({required this.repository});

  Future<Product> call(CreateProductParams params) async {
    try {
      // âœ… 1. Business Validation
      _validateProduct(params);

      // âœ… 2. Create Product Entity
      final product = Product(
        name: params.name,
        nameAr: params.nameAr,
        description: params.description,
        descriptionAr: params.descriptionAr,
        price: params.price,
        mainCategoryId: params.mainCategoryId,
        subCategoryId: params.subCategoryId,
        imageUrl: params.imageUrl,
        isAvailable: params.isAvailable,
        isFeatured: params.isFeatured,
        preparationTime: params.preparationTime,
        sortOrder: params.sortOrder,
        ingredients: params.ingredients,
        allergens: params.allergens,
      );

      // âœ… 3. Save Product
      return await repository.createProduct(product);
    } catch (e) {
      throw Exception('Failed to create product: $e');
    }
  }

  // âœ… Business Validation ÙÙŠ UseCase
  void _validateProduct(CreateProductParams params) {
    final errors = <String>[];

    if (params.name.isEmpty) {
      errors.add('Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ø·Ù„ÙˆØ¨');
    }

    if (params.nameAr.isEmpty) {
      errors.add('Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù…Ø·Ù„ÙˆØ¨');
    }

    if (params.price <= 0) {
      errors.add('Ø§Ù„Ø³Ø¹Ø± ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±');
    }

    if (params.mainCategoryId <= 0) {
      errors.add('ÙŠØ¬Ø¨ Ø§Ø®ØªÙŠØ§Ø± ÙØ¦Ø© Ø±Ø¦ÙŠØ³ÙŠØ©');
    }

    // âœ… Additional Validations
    if (params.name.length < 2) {
      errors.add('Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ«Ø± Ù…Ù† Ø­Ø±ÙÙŠÙ†');
    }

    if (params.nameAr.length < 2) {
      errors.add('Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ«Ø± Ù…Ù† Ø­Ø±ÙÙŠÙ†');
    }

    if (params.price > 1000) {
      errors.add('Ø§Ù„Ø³Ø¹Ø± ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£Ù‚Ù„ Ù…Ù† 1000');
    }

    if (params.preparationTime != null && params.preparationTime! < 0) {
      errors.add('ÙˆÙ‚Øª Ø§Ù„ØªØ­Ø¶ÙŠØ± ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù…ÙˆØ¬Ø¨');
    }

    if (params.sortOrder != null && params.sortOrder! < 0) {
      errors.add('ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…Ù†ØªØ¬ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù…ÙˆØ¬Ø¨');
    }

    if (errors.isNotEmpty) {
      throw Exception(errors.join(', '));
    }
  }
}
```

**ğŸ¯ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:**
- **Business Logic:** Ù…Ù†Ø·Ù‚ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„
- **Validation:** Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- **Orchestration:** ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª
- **Error Handling:** Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡

---

## ğŸ¨ **3. Presentation Layer (Ø·Ø¨Ù‚Ø© Ø§Ù„Ø¹Ø±Ø¶)**

### ğŸ® **3.1 Events**

**Ø§Ù„Ù…Ù„Ù:** `presentation/cubit/product_events.dart`

```dart
import '../../domain/usecases/create_product_usecase.dart';

abstract class ProductEvent {}

class LoadProducts extends ProductEvent {}

class CreateProduct extends ProductEvent {
  final CreateProductParams params; // âœ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Params
  CreateProduct(this.params);
}

class UpdateProduct extends ProductEvent {
  final CreateProductParams params; // âœ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Params
  UpdateProduct(this.params);
}

class ResetProductForm extends ProductEvent {}

class ValidateProduct extends ProductEvent {
  final CreateProductParams params; // âœ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Params
  ValidateProduct(this.params);
}
```

**ğŸ¯ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:**
- **ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª:** Ù…Ø§ ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙØ¹Ù„Ù‡
- **Ù†Ù‚Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:** Ù†Ù‚Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† UI Ø¥Ù„Ù‰ Cubit
- **ÙØµÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:** ÙƒÙ„ Event Ù„Ù‡ Ù‡Ø¯Ù Ù…Ø­Ø¯Ø¯

### ğŸ“Š **3.2 States**

**Ø§Ù„Ù…Ù„Ù:** `presentation/cubit/product_states.dart`

```dart
import 'package:equatable/equatable.dart';
import '../../domain/entities/product.dart';

abstract class ProductState extends Equatable {
  const ProductState();

  @override
  List<Object?> get props => [];
}

class ProductInitial extends ProductState {}

class ProductLoading extends ProductState {}

class ProductsLoaded extends ProductState {
  final List<Product> products;

  const ProductsLoaded(this.products);

  @override
  List<Object?> get props => [products];
}

class ProductCreated extends ProductState {
  final Product product;

  const ProductCreated(this.product);

  @override
  List<Object?> get props => [product];
}

class ProductUpdated extends ProductState {
  final Product product;

  const ProductUpdated(this.product);

  @override
  List<Object?> get props => [product];
}

// âœ… Error States
class ProductValidationError extends ProductState {
  final String message;

  const ProductValidationError(this.message);

  @override
  List<Object?> get props => [message];
}

class ProductAuthError extends ProductState {
  final String message;

  const ProductAuthError(this.message);

  @override
  List<Object?> get props => [message];
}

class ProductError extends ProductState {
  final String message;

  const ProductError(this.message);

  @override
  List<Object?> get props => [message];
}

class ProductFormReset extends ProductState {}

class ProductFormValidated extends ProductState {
  final bool isValid;
  final List<String> errors;

  const ProductFormValidated({
    required this.isValid,
    required this.errors,
  });

  @override
  List<Object?> get props => [isValid, errors];
}
```

**ğŸ¯ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:**
- **ØªÙ…Ø«ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„Ø©:** Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙÙŠ ÙƒÙ„ Ù„Ø­Ø¸Ø©
- **Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡:** Ø­Ø§Ù„Ø§Øª Ù…Ø®ØªÙ„ÙØ© Ù„Ù„Ø£Ø®Ø·Ø§Ø¡
- **ØªÙˆØ¬ÙŠÙ‡ UI:** Ù…Ø§ ÙŠØ¬Ø¨ Ø¹Ø±Ø¶Ù‡ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…

### ğŸ¯ **3.3 Cubit (State Management)**

**Ø§Ù„Ù…Ù„Ù:** `presentation/cubit/product_cubit.dart`

```dart
import 'package:flutter_bloc/flutter_bloc.dart';
import 'dart:developer';
import '../../domain/entities/product.dart';
import '../../domain/usecases/get_products_usecase.dart';
import '../../domain/usecases/create_product_usecase.dart';
import 'product_events.dart';
import 'product_states.dart';

class ProductCubit extends Bloc<ProductEvent, ProductState> {
  final GetProductsUseCase getProductsUseCase;
  final CreateProductUseCase createProductUseCase;

  ProductCubit({
    required this.getProductsUseCase,
    required this.createProductUseCase,
  }) : super(ProductInitial()) {
    on<LoadProducts>(_onLoadProducts);
    on<CreateProduct>(_onCreateProduct);
    on<UpdateProduct>(_onUpdateProduct);
    on<ResetProductForm>(_onResetProductForm);
    on<ValidateProduct>(_onValidateProduct);
  }

  Future<void> _onLoadProducts(
    LoadProducts event,
    Emitter<ProductState> emit,
  ) async {
    emit(ProductLoading());
    try {
      log('ğŸ”„ ProductCubit: Loading products...');
      final products = await getProductsUseCase();
      log(
        'âœ… ProductCubit: Products loaded successfully - ${products.length} products',
      );
      emit(ProductsLoaded(products));
    } catch (e) {
      log('âŒ ProductCubit: Failed to load products - $e');
      emit(ProductError(e.toString()));
    }
  }

  Future<void> _onCreateProduct(
    CreateProduct event,
    Emitter<ProductState> emit,
  ) async {
    emit(ProductLoading());
    try {
      log('ğŸ”„ ProductCubit: Creating product - ${event.params.name}');
      log('ğŸ”„ ProductCubit: Product params - ${event.params.toString()}');

      // âœ… Ø§Ø³ØªØ®Ø¯Ø§Ù… UseCase Ù…Ø¹ Params
      final createdProduct = await createProductUseCase(event.params);

      log(
        'âœ… ProductCubit: Product created successfully - ${createdProduct.name}',
      );
      log('âœ… ProductCubit: Created product ID - ${createdProduct.id}');

      emit(ProductCreated(createdProduct));
    } catch (e) {
      log('âŒ ProductCubit: Failed to create product - $e');
      
      // âœ… Ù…Ø¹Ø§Ù„Ø¬Ø© Ø£Ø®Ø·Ø§Ø¡ Ù…Ø®ØªÙ„ÙØ©
      if (e.toString().contains('Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬') || 
          e.toString().contains('Ø§Ù„Ø³Ø¹Ø±') || 
          e.toString().contains('ÙØ¦Ø©')) {
        emit(ProductValidationError(e.toString()));
      } else if (e.toString().contains('ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„') || 
                 e.toString().contains('Ù…ØµØ§Ø¯Ù‚Ø©')) {
        emit(ProductAuthError(e.toString()));
      } else {
        emit(ProductError(e.toString()));
      }
    }
  }

  Future<void> _onUpdateProduct(
    UpdateProduct event,
    Emitter<ProductState> emit,
  ) async {
    emit(ProductLoading());
    try {
      log('ğŸ”„ ProductCubit: Updating product - ${event.params.name}');
      log('ğŸ”„ ProductCubit: Product params - ${event.params.toString()}');

      // TODO: Implement UpdateProductUseCase
      // final updatedProduct = await updateProductUseCase(event.params);

      log(
        'âœ… ProductCubit: Product updated successfully - ${event.params.name}',
      );

      emit(ProductUpdated(Product(
        name: event.params.name,
        nameAr: event.params.nameAr,
        price: event.params.price,
        mainCategoryId: event.params.mainCategoryId,
      )));
    } catch (e) {
      log('âŒ ProductCubit: Failed to update product - $e');
      emit(ProductError(e.toString()));
    }
  }

  void _onResetProductForm(ResetProductForm event, Emitter<ProductState> emit) {
    log('ğŸ”„ ProductCubit: Resetting product form');
    emit(ProductFormReset());
  }

  void _onValidateProduct(ValidateProduct event, Emitter<ProductState> emit) {
    log('ğŸ”„ ProductCubit: Validating product - ${event.params.name}');

    final errors = <String>[];

    // âœ… Basic Validation
    if (event.params.name.isEmpty) {
      errors.add('Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ø·Ù„ÙˆØ¨');
    }

    if (event.params.nameAr.isEmpty) {
      errors.add('Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù…Ø·Ù„ÙˆØ¨');
    }

    if (event.params.price <= 0) {
      errors.add('Ø§Ù„Ø³Ø¹Ø± ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±');
    }

    if (event.params.mainCategoryId <= 0) {
      errors.add('ÙŠØ¬Ø¨ Ø§Ø®ØªÙŠØ§Ø± ÙØ¦Ø© Ø±Ø¦ÙŠØ³ÙŠØ©');
    }

    // âœ… Additional Validations
    if (event.params.name.length < 2) {
      errors.add('Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ«Ø± Ù…Ù† Ø­Ø±ÙÙŠÙ†');
    }

    if (event.params.nameAr.length < 2) {
      errors.add('Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ«Ø± Ù…Ù† Ø­Ø±ÙÙŠÙ†');
    }

    if (event.params.price > 1000) {
      errors.add('Ø§Ù„Ø³Ø¹Ø± ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£Ù‚Ù„ Ù…Ù† 1000');
    }

    final isValid = errors.isEmpty;

    log(
      'âœ… ProductCubit: Product validation completed - Valid: $isValid, Errors: ${errors.length}',
    );

    emit(ProductFormValidated(isValid: isValid, errors: errors));
  }
}
```

**ğŸ¯ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:**
- **State Management:** Ø¥Ø¯Ø§Ø±Ø© Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
- **Event Handling:** Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
- **UseCase Coordination:** ØªÙ†Ø³ÙŠÙ‚ UseCases
- **Error Handling:** Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡

### ğŸ¨ **3.4 UI (User Interface)**

**Ø§Ù„Ù…Ù„Ù:** `presentation/pages/admin_add_item_page.dart`

```dart
import 'package:flutter/material.dart';
import 'package:flutter_bloc/flutter_bloc.dart';
import 'package:flutter_screenutil/flutter_screenutil.dart';
import '../../../../../../../core/theme/theme_helper.dart';
import '../../../../../../../core/utils/responsive_helper.dart';
import '../cubit/product_events.dart';
import '../cubit/product_states.dart';
import '../widgets/index.dart';
import '../cubit/product_cubit.dart';
import '../../domain/usecases/create_product_usecase.dart';
import '../../../../../../../core/di/service_locator.dart';

class AdminAddItemPage extends StatefulWidget {
  const AdminAddItemPage({super.key});

  @override
  State<AdminAddItemPage> createState() => _AdminAddItemPageState();
}

class _AdminAddItemPageState extends State<AdminAddItemPage> {
  final _formKey = GlobalKey<FormState>();

  // âœ… Controllers ÙÙ‚Ø·
  final _nameController = TextEditingController();
  final _priceController = TextEditingController();
  final _detailsController = TextEditingController();
  final _nameArController = TextEditingController();
  final _detailsArController = TextEditingController();
  final _preparationTimeController = TextEditingController();
  final _sortOrderController = TextEditingController();

  // âœ… Product settings
  bool _isAvailable = true;
  bool _isFeatured = false;

  // âœ… Category selection
  String? _selectedMainCategory;
  String? _selectedSubCategory;

  // âœ… Lists for ingredients and allergens
  List<String> _selectedIngredients = [];
  List<String> _selectedAllergens = [];

  // âœ… Existing fields
  List<String> _uploadedImages = <String>[];
  bool _isPickupSelected = false;
  bool _isDeliverySelected = false;
  Set<String> _selectedBasicIngredients = {};
  Set<String> _selectedFruitIngredients = {};
  String? _selectedMealCategory;

  @override
  void dispose() {
    _nameController.dispose();
    _priceController.dispose();
    _detailsController.dispose();
    _nameArController.dispose();
    _detailsArController.dispose();
    _preparationTimeController.dispose();
    _sortOrderController.dispose();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    return BlocProvider(
      create: (context) => getIt<ProductCubit>(),
      child: BlocListener<ProductCubit, ProductState>(
        listener: (context, state) {
          if (state is ProductCreated) {
            ScaffoldMessenger.of(context).showSnackBar(
              SnackBar(
                content: Text('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­'),
                backgroundColor: Colors.green,
              ),
            );
            Navigator.pop(context);
          } else if (state is ProductValidationError) {
            ScaffoldMessenger.of(context).showSnackBar(
              SnackBar(
                content: Text('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${state.message}'),
                backgroundColor: Colors.orange,
              ),
            );
          } else if (state is ProductAuthError) {
            ScaffoldMessenger.of(context).showSnackBar(
              SnackBar(
                content: Text('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©: ${state.message}'),
                backgroundColor: Colors.red,
              ),
            );
          } else if (state is ProductError) {
            ScaffoldMessenger.of(context).showSnackBar(
              SnackBar(
                content: Text('Ø®Ø·Ø£: ${state.message}'),
                backgroundColor: Colors.red,
              ),
            );
          }
        },
        child: BlocBuilder<ProductCubit, ProductState>(
          builder: (context, state) {
            return Scaffold(
              backgroundColor: ThemeHelper.getBackgroundColor(context),
              appBar: CustomAppBar(
                onBackPressed: () => Navigator.pop(context),
                onResetPressed: _onResetPressed,
              ),
              body: SafeArea(
                child: ResponsiveHelper.responsiveLayout(
                  builder: (context, constraints) {
                    return Padding(
                      padding: EdgeInsets.symmetric(
                        horizontal: ResponsiveHelper.isMobile(context)
                            ? 24.w
                            : 32.w,
                      ),
                      child: AddItemFormWidget(
                        formKey: _formKey,
                        // English fields
                        nameController: _nameController,
                        priceController: _priceController,
                        detailsController: _detailsController,
                        // Arabic fields
                        nameArController: _nameArController,
                        detailsArController: _detailsArController,
                        // Additional fields
                        preparationTimeController: _preparationTimeController,
                        sortOrderController: _sortOrderController,
                        // Product settings
                        isAvailable: _isAvailable,
                        isFeatured: _isFeatured,
                        onAvailableChanged: (value) {
                          setState(() {
                            _isAvailable = value;
                          });
                        },
                        onFeaturedChanged: (value) {
                          setState(() {
                            _isFeatured = value;
                          });
                        },
                        // Category selection
                        selectedMainCategory: _selectedMainCategory,
                        selectedSubCategory: _selectedSubCategory,
                        onMainCategoryChanged: (category) {
                          setState(() {
                            _selectedMainCategory = category;
                            _selectedSubCategory = null;
                          });
                        },
                        onSubCategoryChanged: (category) {
                          setState(() {
                            _selectedSubCategory = category;
                          });
                        },
                        // Ingredients and allergens
                        selectedIngredients: _selectedIngredients,
                        selectedAllergens: _selectedAllergens,
                        onIngredientsChanged: (ingredients) {
                          setState(() {
                            _selectedIngredients = ingredients;
                          });
                        },
                        onAllergensChanged: (allergens) {
                          setState(() {
                            _selectedAllergens = allergens;
                          });
                        },
                        // Existing fields
                        uploadedImages: _uploadedImages,
                        isPickupSelected: _isPickupSelected,
                        isDeliverySelected: _isDeliverySelected,
                        selectedBasicIngredients: _selectedBasicIngredients,
                        selectedFruitIngredients: _selectedFruitIngredients,
                        selectedMealCategory: _selectedMealCategory,
                        onAddMediaPressed: _onAddMediaPressed,
                        onPickupChanged: (value) {
                          setState(() {
                            _isPickupSelected = value;
                          });
                        },
                        onDeliveryChanged: (value) {
                          setState(() {
                            _isDeliverySelected = value;
                          });
                        },
                        onBasicIngredientToggled: (ingredientId) {
                          setState(() {
                            if (_selectedBasicIngredients.contains(ingredientId)) {
                              _selectedBasicIngredients.remove(ingredientId);
                            } else {
                              _selectedBasicIngredients.add(ingredientId);
                            }
                          });
                        },
                        onFruitIngredientToggled: (ingredientId) {
                          setState(() {
                            if (_selectedFruitIngredients.contains(ingredientId)) {
                              _selectedFruitIngredients.remove(ingredientId);
                            } else {
                              _selectedFruitIngredients.add(ingredientId);
                            }
                          });
                        },
                        onBasicSeeAllPressed: () {
                          // TODO: Navigate to see all basic ingredients
                        },
                        onFruitSeeAllPressed: () {
                          // TODO: Navigate to see all fruit ingredients
                        },
                        onMealCategoryChanged: (category) {
                          setState(() {
                            _selectedMealCategory = category;
                          });
                        },
                        onSavePressed: () => _onSaveChanges(context),
                      ),
                    );
                  },
                ),
              ),
            );
          },
        ),
      ),
    );
  }

  void _onAddMediaPressed() {
    // TODO: Implement media picker
    setState(() {
      if (_uploadedImages.isEmpty) {
        _uploadedImages.add('assets/images/chickenburger.jpg');
      }
    });
  }

  void _onResetPressed() {
    setState(() {
      // Clear English fields
      _nameController.clear();
      _priceController.clear();
      _detailsController.clear();

      // Clear Arabic fields
      _nameArController.clear();
      _detailsArController.clear();

      // Clear additional fields
      _preparationTimeController.clear();
      _sortOrderController.clear();

      // Reset settings
      _isAvailable = true;
      _isFeatured = false;

      // Reset categories
      _selectedMainCategory = null;
      _selectedSubCategory = null;

      // Reset ingredients and allergens
      _selectedIngredients.clear();
      _selectedAllergens.clear();

      // Clear existing fields
      _uploadedImages.clear();
      _isPickupSelected = false;
      _isDeliverySelected = false;
      _selectedBasicIngredients = {};
      _selectedFruitIngredients.clear();
      _selectedMealCategory = null;
    });
  }

  // âœ… UI method Ù…Ø¨Ø³Ø· - Ø¥Ù†Ø´Ø§Ø¡ Params ÙÙ‚Ø·
  void _onSaveChanges(BuildContext context) {
    if (_formKey.currentState!.validate()) {
      // âœ… Ø¥Ù†Ø´Ø§Ø¡ Params ÙÙ‚Ø·
      final params = CreateProductParams(
        name: _nameController.text.trim(),
        nameAr: _nameArController.text.trim(),
        description: _detailsController.text.trim(),
        descriptionAr: _detailsArController.text.trim(),
        price: double.tryParse(_priceController.text) ?? 0.0,
        mainCategoryId: int.tryParse(_selectedMainCategory ?? '1') ?? 1,
        subCategoryId: _selectedSubCategory != null
            ? int.tryParse(_selectedSubCategory!)
            : null,
        imageUrl: _uploadedImages.isNotEmpty ? _uploadedImages.first : null,
        isAvailable: _isAvailable,
        isFeatured: _isFeatured,
        preparationTime: _preparationTimeController.text.isNotEmpty
            ? int.tryParse(_preparationTimeController.text)
            : null,
        sortOrder: _sortOrderController.text.isNotEmpty
            ? int.tryParse(_sortOrderController.text)
            : null,
        ingredients: _selectedIngredients.isNotEmpty ? _selectedIngredients : null,
        allergens: _selectedAllergens.isNotEmpty ? _selectedAllergens : null,
      );

      // âœ… Ø¥Ø±Ø³Ø§Ù„ Params ÙÙ‚Ø·
      BlocProvider.of<ProductCubit>(context, listen: false)
          .add(CreateProduct(params));
    }
  }
}
```

**ğŸ¯ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:**
- **Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:** Ø¹Ø±Ø¶ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ ÙˆØ§Ù„Ø­Ù‚ÙˆÙ„
- **Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:** Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
- **Ø¥Ù†Ø´Ø§Ø¡ Params:** ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Params
- **Ø¥Ø±Ø³Ø§Ù„ Events:** Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„Ù€ Cubit
- **Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬:** Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙˆØ§Ù„Ø£Ø®Ø·Ø§Ø¡

---

## ğŸ”„ **ØªØ¯ÙÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„**

### âœ… **Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨:**

```
1. UI ÙŠØ¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Form
   â†“
2. UI ÙŠÙ†Ø´Ø¦ CreateProductParams
   â†“
3. UI ÙŠØ±Ø³Ù„ CreateProduct Event Ù„Ù„Ù€ Cubit
   â†“
4. Cubit ÙŠØ³ØªÙ‚Ø¨Ù„ Event ÙˆÙŠØ³ØªØ¯Ø¹ÙŠ UseCase
   â†“
5. UseCase ÙŠØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Params
   â†“
6. UseCase ÙŠÙ†Ø´Ø¦ Product Entity
   â†“
7. UseCase ÙŠØ±Ø³Ù„ Entity Ù„Ù„Ù€ Repository
   â†“
8. Repository ÙŠØ­ÙˆÙ„ Entity Ø¥Ù„Ù‰ Model
   â†“
9. Repository ÙŠØ±Ø³Ù„ Model Ù„Ù„Ù€ Remote Data Source
   â†“
10. Remote Data Source ÙŠØ­ÙˆÙ„ Model Ø¥Ù„Ù‰ JSON
    â†“
11. Remote Data Source ÙŠØ±Ø³Ù„ JSON Ù„Ù„Ù€ API
    â†“
12. API ÙŠØ±Ø¬Ø¹ JSON Ù„Ù„Ù€ Remote Data Source
    â†“
13. Remote Data Source ÙŠØ­ÙˆÙ„ JSON Ø¥Ù„Ù‰ Model
    â†“
14. Repository ÙŠØ­ÙˆÙ„ Model Ø¥Ù„Ù‰ Entity
    â†“
15. UseCase ÙŠØ±Ø¬Ø¹ Entity Ù„Ù„Ù€ Cubit
    â†“
16. Cubit ÙŠØ±Ø³Ù„ State Ù„Ù„Ù€ UI
    â†“
17. UI ÙŠØ¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
```

---

## ğŸ¯ **Ø§Ù„Ù…Ø²Ø§ÙŠØ§ Ø§Ù„Ù…Ø­Ù‚Ù‚Ø©**

### âœ… **1. ÙØµÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:**

```dart
// âœ… ÙƒÙ„ Ø·Ø¨Ù‚Ø© Ù„Ù‡Ø§ Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ù…Ø­Ø¯Ø¯Ø©
Data Layer: ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…
Domain Layer: Business Logic ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
Presentation Layer: Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø§Ù„Ø©
```

### âœ… **2. Ø³Ù‡ÙˆÙ„Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:**

```dart
// âœ… ÙŠÙ…ÙƒÙ† Ø§Ø®ØªØ¨Ø§Ø± ÙƒÙ„ Ø·Ø¨Ù‚Ø© Ù…Ù†ÙØµÙ„Ø©
test('Data Layer should convert JSON to Model', () {
  // Ø§Ø®ØªØ¨Ø§Ø± Data Layer
});

test('Domain Layer should validate data', () {
  // Ø§Ø®ØªØ¨Ø§Ø± Domain Layer
});

test('Presentation Layer should handle events', () {
  // Ø§Ø®ØªØ¨Ø§Ø± Presentation Layer
});
```

### âœ… **3. Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:**

```dart
// âœ… ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù… UseCase ÙÙŠ Ø£Ù…Ø§ÙƒÙ† Ù…Ø®ØªÙ„ÙØ©
final createProductUseCase = CreateProductUseCase(repository);

// ÙÙŠ Cubit
final product = await createProductUseCase(params);

// ÙÙŠ Service
final product = await createProductUseCase(params);

// ÙÙŠ Test
final product = await createProductUseCase(testParams);
```

### âœ… **4. Ø³Ù‡ÙˆÙ„Ø© Ø§Ù„ØµÙŠØ§Ù†Ø©:**

```dart
// âœ… ØªØºÙŠÙŠØ± UI Ù„Ø§ ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ Business Logic
// âœ… ØªØºÙŠÙŠØ± Business Logic Ù„Ø§ ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ UI
// âœ… ØªØºÙŠÙŠØ± Database Ù„Ø§ ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ Business Logic
```

---

## ğŸš€ **ÙƒÙŠÙ ØªØ·Ø¨Ù‚ Ù‡Ø°Ø§ ÙÙŠ Ù…Ø´Ø§Ø±ÙŠØ¹ÙƒØŸ**

### âœ… **Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ©:**

1. **Ø§Ø¨Ø¯Ø£ Ø¨Ù€ Data Layer:** Ø£Ù†Ø´Ø¦ Models Ùˆ Remote Data Sources
2. **Ø£Ù†Ø´Ø¦ Domain Layer:** Ø£Ù†Ø´Ø¦ Entities Ùˆ Repository Interfaces
3. **Ø£Ù†Ø´Ø¦ UseCases:** Ø¶Ø¹ Business Logic ÙÙŠ UseCases
4. **Ø£Ù†Ø´Ø¦ Presentation Layer:** Ø£Ù†Ø´Ø¦ Events Ùˆ States Ùˆ Cubit
5. **Ø£Ù†Ø´Ø¦ UI:** Ø§Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙ‚Ø·

### âœ… **Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©:**

```
Presentation Layer â†’ Params â†’ Domain Layer â†’ Entity
```

**Ø§Ù„Ù†ØªÙŠØ¬Ø©:** ÙƒÙˆØ¯ Ù…Ù†Ø¸Ù…ØŒ Ø³Ù‡Ù„ Ø§Ù„ØµÙŠØ§Ù†Ø©ØŒ Ù‚Ø§Ø¨Ù„ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±! ğŸ‰

---

## ğŸ“š **Ù…Ù„ÙØ§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù…Ù‡Ù…Ø©**

### âœ… **Dependency Injection:**

```dart
// ÙÙŠ core/di/service_locator.dart
void setupProductDependencies() {
  // Data Layer
  getIt.registerLazySingleton<ProductRemoteDataSource>(
    () => ProductRemoteDataSourceImpl(dioClient: getIt()),
  );
  
  getIt.registerLazySingleton<ProductRepository>(
    () => ProductRepositoryImpl(remoteDataSource: getIt()),
  );
  
  // Domain Layer
  getIt.registerLazySingleton<CreateProductUseCase>(
    () => CreateProductUseCase(repository: getIt()),
  );
  
  getIt.registerLazySingleton<GetProductsUseCase>(
    () => GetProductsUseCase(repository: getIt()),
  );
  
  // Presentation Layer
  getIt.registerFactory<ProductCubit>(
    () => ProductCubit(
      getProductsUseCase: getIt(),
      createProductUseCase: getIt(),
    ),
  );
}
```

### âœ… **API Paths:**

```dart
// ÙÙŠ core/network/api_path.dart
class ApiPath {
  static const String products = '/products';
  static const String categories = '/categories';
  // ... Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª
}
```

---

## ğŸ‰ **Ø§Ù„Ø®Ù„Ø§ØµØ©**

Ù‡Ø°Ø§ Ø§Ù„Ø¯Ù„ÙŠÙ„ ÙŠØ´Ø±Ø­ Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ© Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ù„Ù†Ø¸Ø§Ù… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§ØªØŒ Ù…Ù† Data Layer Ø¥Ù„Ù‰ Presentation Layer. ÙƒÙ„ Ø·Ø¨Ù‚Ø© Ù„Ù‡Ø§ Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ù…Ø­Ø¯Ø¯Ø©ØŒ Ù…Ù…Ø§ ÙŠØ¬Ø¹Ù„ Ø§Ù„ÙƒÙˆØ¯ Ù…Ù†Ø¸Ù…ØŒ Ø³Ù‡Ù„ Ø§Ù„ØµÙŠØ§Ù†Ø©ØŒ ÙˆÙ‚Ø§Ø¨Ù„ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±.

**Ø§Ù„Ù…ÙØªØ§Ø­ Ù„Ù„Ù†Ø¬Ø§Ø­:** Ø§ØªØ¨Ø¹ Clean Architecture ÙˆÙØµÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª Ø¨ÙŠÙ† Ø§Ù„Ø·Ø¨Ù‚Ø§Øª! ğŸš€ 